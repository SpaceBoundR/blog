<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>网易有钱 on 电子荒原</title>
    <link>http://localhost:1313/tags/%E7%BD%91%E6%98%93%E6%9C%89%E9%92%B1/</link>
    <description>Recent content in 网易有钱 on 电子荒原</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <copyright>&amp;copy;召唤兽，&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
    <lastBuildDate>Thu, 07 Nov 2019 21:58:22 +0800</lastBuildDate>
    
	<atom:link href="http://localhost:1313/tags/%E7%BD%91%E6%98%93%E6%9C%89%E9%92%B1/feed.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Beancount试用,半年后</title>
      <link>http://localhost:1313/2019/11/07/netease-youqian-with-beancount/</link>
      <pubDate>Thu, 07 Nov 2019 21:58:22 +0800</pubDate>
      
      <guid>http://localhost:1313/2019/11/07/netease-youqian-with-beancount/</guid>
      <description>&lt;p&gt;自从2017年开始，我一直使用 &lt;em&gt;网易有钱&lt;/em&gt; 记账。不得不说，如果像某落水狗讲的那样，“中国人不在乎隐私”的话，这确实是一个非常好用的APP，下载账单、导入数据一气呵成，连余额宝的利息都能够算得分毫不差——&lt;/p&gt;
&lt;p&gt;直到最近，大概是骂挨得太多，或是界面里终于塞不下更多广告，这个APP①用“维护中”挡住了所有同步按钮，并且②停止了维护。&lt;/p&gt;
&lt;p&gt;用8元买回了本属于自己的数据后，我想起之前听说过的&lt;a href=&#34;https://www.byvoid.com/zht/blog/beancount-bookkeeping-1&#34;&gt;Beancount&lt;/a&gt;。于是，我给那些数据找到了一些新用途。&lt;/p&gt;
&lt;h2 id=&#34;冷启动&#34;&gt;冷启动&lt;/h2&gt;
&lt;p&gt;首先，我阅读了&lt;a href=&#34;https://yuchi.me/post/beancount-intro/&#34;&gt;这篇博文&lt;/a&gt;，搭起了Beancount。接着，我又写了一些其它的&lt;a href=&#34;https://github.com/heyeshuang/beancount-homemade-importers&#34;&gt;脚本&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&#34;自动建立收支账户&#34;&gt;自动建立收支账户&lt;/h3&gt;
&lt;p&gt;之前的理财软件大多会提供一些初始分类，比如说mint所用的类别列表在&lt;a href=&#34;https://www.mint.com/mint-categories&#34;&gt;这里&lt;/a&gt;。
对于本人&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;之前的账本，有过记录的大概是这样几类：&lt;/p&gt;
&lt;p&gt;&lt;code&gt; {&#39;交通,&#39;, &#39;交通,打车&#39;, &#39;交通,机票&#39;, &#39;交通,火车&#39;, &#39;人情,&#39;, &#39;住房,&#39;, &#39;住房,家具&#39;, &#39;住房,家纺&#39;, &#39;住房,物业水电&#39;, &#39;住房,装修&#39;, &#39;其他,&#39;, &#39;医疗,&#39;, &#39;医疗,药品&#39;, &#39;娱乐,&#39;, &#39;娱乐,电影&#39;, &#39;投资亏损,&#39;, &#39;文教,&#39;, &#39;文教,书刊&#39;, &#39;文教,文具&#39;, &#39;旅行,&#39;, &#39;旅行,景点门票&#39;, &#39;旅行,酒店&#39;, &#39;汽车,&#39;, &#39;购物,&#39;, &#39;购物,数码&#39;, &#39;购物,日用&#39;, &#39;购物,玩具&#39;, &#39;购物,电器&#39;, &#39;购物,美妆&#39;, &#39;购物,运动用品&#39;, &#39;购物,鞋服&#39;, &#39;购物,饰品&#39;, &#39;通讯,&#39;, &#39;通讯,话费&#39;, &#39;零食烟酒,&#39;, &#39;零食烟酒,水果&#39;, &#39;零食烟酒,烟酒&#39;, &#39;零食烟酒,茶水&#39;, &#39;零食烟酒,零食&#39;, &#39;零食烟酒,饮料&#39;, &#39;餐饮,&#39;, &#39;餐饮,三餐&#39;, &#39;餐饮,食材&#39;} &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;对这些分类，利用人工&lt;del&gt;智能&lt;/del&gt;，为每一项建立了对应的&lt;code&gt;account&lt;/code&gt;，形成了一个&lt;a href=&#34;https://github.com/heyeshuang/beancount-homemade-importers/blob/master/importers/youqian/youqianDict.py&#34;&gt;dict&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;如果你已经下载了&lt;a href=&#34;https://github.com/heyeshuang/beancount-homemade-importers&#34;&gt;beancount-homemade-importers&lt;/a&gt;，你可以用里面的&lt;code&gt;importers/ youqian/accountInit.py&lt;/code&gt;来自动建立这些&lt;code&gt;accounts&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python importers/youqian/accountInit.py &amp;gt; New_Accounts.bean
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;# 或：如果之前已经建立了一些账户的话&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python importers/youqian/accountInit.py Existing_Accounts.bean &amp;gt; New_Accounts.bean
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;导入网易有钱的收入支出数据&#34;&gt;导入网易有钱的收入、支出数据&lt;/h3&gt;
&lt;p&gt;Beancount的&lt;a href=&#34;https://docs.google.com/document/d/11EwQdujzEo2cxqaF5PgxCEZXWfKKQCYSMfdJowp_1S8/edit#&#34;&gt;文档&lt;/a&gt;里已经对导入脚本进行了比较详细的说明。从&lt;a href=&#34;https://bitbucket.org/blais/beancount/src/tip/examples/ingest/office/importers/utrade/&#34;&gt;这个例子&lt;/a&gt;开始，基本上只要实现几个函数就行。&lt;/p&gt;
&lt;p&gt;在&lt;a href=&#34;https://github.com/heyeshuang/beancount-homemade-importers&#34;&gt;beancount-homemade-importers&lt;/a&gt;中，我写了一个简单的网易有钱导入脚本。在使用之前，需要用excel把默认的&lt;code&gt;xlsx&lt;/code&gt;格式转换为&lt;code&gt;收入.csv&lt;/code&gt;和&lt;code&gt;支出.csv&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;之后，使用&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bean-extract importers/youqian/youqian_expense.import documents.tmp/支出.csv &amp;gt; 支出.bean
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bean-extract importers/youqian/youqian_income.import documents.tmp/收入.csv &amp;gt; 收入.bean
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;来导入。&lt;/p&gt;
&lt;h2 id=&#34;自动记账&#34;&gt;自动记账&lt;/h2&gt;
&lt;p&gt;写下这个标题是在2020年6月。在使用beancount半年之后，账本一共增加了270条内容，所需的时间每月不超过1小时。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;%E6%9D%A1%E7%9B%AE.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;梳理资金的流向&#34;&gt;梳理资金的流向&lt;/h3&gt;
&lt;p&gt;作为一个单身工薪族，我的&lt;del&gt;主要&lt;/del&gt;全部收入来自于工资，在经过一些卡片后，从微信、支付宝和其他地方流走。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;mermaid-diagram.svg&#34; alt=&#34;用mermaid画的流程图&#34;&gt;&lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;
  &lt;h4 class=&#34;inline&#34;&gt;
    (这张图是用mermaid画的，这里是源代码)
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;graph LR;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    linkStyle default interpolate basis
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    subgraph one [开销]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    A([支付宝]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    B([微信]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    G([&amp;#34;京东、刷卡&amp;#34;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    H([理财]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    end
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    subgraph two [收入]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    C[工商银行];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    end
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    D[农业银行];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    E([中国银行]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    F([招商银行]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    E --&amp;gt; H
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    E &amp;amp; F --&amp;gt; A &amp;amp; B
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    C --&amp;gt;  E &amp;amp; D &amp;amp; F
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    F --&amp;gt; G
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    classDef auto fill:#9ACFBF
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    class B,E,F auto
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/details&gt;
&lt;p&gt;其中，有一些银行卡（比如图中的农业银行）每月的转账记录不超过2条，这时候只要手工敲上几行就可以了。对于另外的、日常生活的花费，手动记录带来了大量时间的浪费。这时候，找到流动的枢纽，并对它们的账单进行批量处理，就可以从重复劳动中解放出来。对于我来说，要进行批量处理的节点是&lt;code&gt;中国银行&lt;/code&gt;，&lt;code&gt;招商银行&lt;/code&gt;和&lt;code&gt;微信&lt;/code&gt;。&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;h3 id=&#34;写一些脚本&#34;&gt;写一些脚本&lt;/h3&gt;
&lt;p&gt;所以，我写了中国银行、招商银行和微信钱包对账单的导入脚本。Beancount拥有比较强大的导入功能，对于简单的、CSV格式的账单文件，只要在自带的&lt;code&gt;beancount.ingest.importers.csv.importer&lt;/code&gt;上&lt;a href=&#34;https://github.com/heyeshuang/beancount-homemade-importers/blob/master/importers/boc.import&#34;&gt;稍作修改&lt;/a&gt;就可以了；对于其它较为复杂的账单，可以自行扩展&lt;code&gt;ImporterProtocol&lt;/code&gt;的子类，在&lt;a href=&#34;https://docs.google.com/document/d/11EwQdujzEo2cxqaF5PgxCEZXWfKKQCYSMfdJowp_1S8/edit#heading=h.z153vh2ll6ix&#34;&gt;官方文档&lt;/a&gt;中有较为详细的说明。&lt;/p&gt;
&lt;p&gt;另外，我还发现了&lt;a href=&#34;https://github.com/beancount/smart_importer&#34;&gt;smart_importer&lt;/a&gt;，只要简单地增加hook，就可以给导入脚本增加更好的去重、智能猜测分类等更帅气的功能。&lt;/p&gt;
&lt;h3 id=&#34;在每个账单日运行一次&#34;&gt;在每个账单日运行一次&lt;/h3&gt;
&lt;p&gt;在账单目录下，我建立了一个&lt;code&gt;TODO&lt;/code&gt;文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;自动导入微信、中国银行和招商（账单日）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;手动导入工行和农行
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;因为微信的账单信息比较多，我一般先从它开始。每月信用卡的账单日，下载微信钱包对账单，然后运行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bean-extract importers/wechat.import documents.tmp/微信支付账单.csv -f main.bean &amp;gt; temp.bean 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中，&lt;code&gt;-f&lt;/code&gt;用来为&lt;code&gt;smart_importer&lt;/code&gt;提供学习素材。&lt;/p&gt;
&lt;p&gt;接下来打开&lt;code&gt;temp.bean&lt;/code&gt;，检查人工&lt;del&gt;智障&lt;/del&gt;智能补充的分类条目有没有什么问题。（大概率问题很多，每个月大部分的时间会花费在这里。）&lt;/p&gt;
&lt;p&gt;之后，将&lt;code&gt;temp.bean&lt;/code&gt;重命名为一个有意义的名字，并在&lt;code&gt;main.bean&lt;/code&gt;中&lt;code&gt;import&lt;/code&gt;。接下來对银行账户的导入过程中，&lt;code&gt;smart_importer&lt;/code&gt;会自动去除重复账单。&lt;/p&gt;
&lt;p&gt;在上面的工作都完成以后，本月的账单也只剩下几条漏网之鱼了。把它们（手动）补充，并用&lt;code&gt;balance&lt;/code&gt;命令检查。&lt;/p&gt;
&lt;h3 id=&#34;并养成记账的好习惯&#34;&gt;并养成“记账的好习惯”&lt;/h3&gt;
&lt;p&gt;在某些问答网站上，在“相见恨晚的习惯”列表，记账大概能排在top10的位置；同时，在“半途而废的习惯”里，位置大概也在附近。原因并不仅仅是“缺乏自制力”，而是手动记账花费了太多时间，而效果并不是立竿见影的。在付出和反馈不成比例时，放弃就成了唯一的选择。&lt;/p&gt;
&lt;p&gt;如果每个月只要十几分钟就可以获得成就感，习惯也就自然地养成了。&lt;/p&gt;
&lt;h2 id=&#34;又及&#34;&gt;又及&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;我跟你港，这次的内容超适合作Python教程的，还能顺便学英语！只要学会了这个，年薪百万不是梦！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;现在诚征 100 个&lt;del&gt;凯子&lt;/del&gt;幸运读者给我打钱，我的支付宝是：……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;呃，对不起。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;以上不代表博主观点。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;一个普通的、抠抠索索的中青年男性，未婚，不修边幅，被阳光照到会燃烧。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;细心的读者可能会注意到，我并没有将支付宝也列入进来，即使和微信的地位相似。这是由于支付宝的账单并不能显示付款账户。通过余额宝和通过信用卡支付，在对账单上没有明确的区分，这会给之后的条目合并造成困难。在开始用beancount之后，因为手动记录太麻烦，我很少用支付宝付款。(update 220426：最近听说支付宝手机版能够看到付款账户，之后可以试试)&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>