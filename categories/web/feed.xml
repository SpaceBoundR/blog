<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Web on 电子荒原</title>
    <link>http://localhost:1313/categories/web/</link>
    <description>Recent content in Web on 电子荒原</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <copyright>&amp;copy;召唤兽，&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
    <lastBuildDate>Wed, 10 May 2023 21:05:13 +0800</lastBuildDate>
    
	<atom:link href="http://localhost:1313/categories/web/feed.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>内网访问第三季：在运营商的CGNAT网络下</title>
      <link>http://localhost:1313/2023/05/10/through-nat/</link>
      <pubDate>Wed, 10 May 2023 21:05:13 +0800</pubDate>
      
      <guid>http://localhost:1313/2023/05/10/through-nat/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;是的，在&lt;a href=&#34;http://localhost:1313/2021/07/20/beyond-nat/&#34;&gt;这次&lt;/a&gt;和&lt;a href=&#34;http://localhost:1313/2022/05/22/connect-every-something//#%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AEtailscaletinc%E6%88%96wireguard&#34;&gt;这次&lt;/a&gt;之后，在酒店里百无聊赖的现在，我又开始折腾起VPN来了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;是的，在酒店里仍然没有IPv6地址。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;为什么&#34;&gt;为什么&lt;/h2&gt;
&lt;p&gt;正如&lt;a href=&#34;http://localhost:1313/2022/05/22/connect-every-something//#%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AEtailscaletinc%E6%88%96wireguard&#34;&gt;前文&lt;/a&gt;所述，无论是Tailscale/Headscale、Nebula或Netmaker，原理均大同小异，都是在Wireguard基础上，用类STUN协议来穿越NAT，或利用TURN（DERP）服务器进行转发。在国内家庭宽带网络环境下，一般存在路由器、光猫、运营商三重NAT防火墙，STUN需要跨越多重阻碍，自动穿越希望渺茫；另一方面，公开转发服务多在国外，延迟高居不下，而国内私有云价格亦是高不可攀，自建服务并非经济的选择。&lt;/p&gt;
&lt;p&gt;然而，三重NAT也并非坚不可摧。光猫一级，只要改为桥接，便可迎刃而解；路由一级，可以通过端口映射来绕过；而运营商级多为NAT1，通过&lt;a href=&#34;https://github.com/MikeWang000000/Natter/tree/v0.9&#34;&gt;Natter&lt;/a&gt;或&lt;a href=&#34;https://github.com/heiher/natmap&#34;&gt;natmap&lt;/a&gt;，可以获得近似公网的效果。这样，使用纯粹的Wireguard，也能够直接回到家庭网络内部，免去国外中转的烦恼。&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/ping1.png&#34;
    alt=&#34;从广东联通到北京联通。&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;从广东联通到北京联通。&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/ping2.png&#34;
    alt=&#34;从广东联通经北京联通到甘肃移动。个人觉得，在这种延迟下追求Full Mesh也不再重要了。&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;从广东联通经北京联通到甘肃移动。个人觉得，在这种延迟下追求Full Mesh也不再重要了。&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;怎么做&#34;&gt;怎么做&lt;/h2&gt;
&lt;p&gt;在开始之前，首先检查是否满足以下要求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;一台长期开启的设备。
&lt;blockquote&gt;
&lt;p&gt;既然有远程访问的要求，远处有一台服务器是很自然的吧。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;光猫处于桥接状态。&lt;/li&gt;
&lt;li&gt;主路由是OpenWRT，或者内网里有DMZ主机。
&lt;blockquote&gt;
&lt;p&gt;或者，你是端口转发专家，可以从光猫外侧一路转发到最内部。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;没有公网IPv4，但在路由器处测试NAT类型为NAT1。
&lt;blockquote&gt;
&lt;p&gt;这里可以用&lt;a href=&#34;https://github.com/MikeWang000000/Natter/tree/v0.9&#34;&gt;Natter&lt;/a&gt;自带的功能来测试。如果你有公网IPv4的话，直接打开端口就好，而且我会很羡慕你。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;一个自己的域名，最好是在Cloudflare上托管的。
&lt;blockquote&gt;
&lt;p&gt;需要DDNS功能实时更新域名。如果没有域名的话，可能需要一些别的手段来实时得到端口。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体配置部分已经有人写的很详细了。首先按照&lt;a href=&#34;https://www.procustodibus.com/blog/2020/11/wireguard-point-to-site-config/&#34;&gt;WireGuard Point to Site Configuration&lt;/a&gt;设置点到站点的连接，然后按照&lt;a href=&#34;https://github.com/heiher/natmap/wiki/wireguard&#34;&gt;natmap Wiki&lt;/a&gt;设置NATMap即可。注意，在路由器上操作的时候，一定要记得在防火墙中&lt;strong&gt;打开对应端口&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;完成以上步骤之后，应该已经可以从移动网络访问内网的Wireguard Peer了。&lt;/p&gt;
&lt;h2 id=&#34;一点问题&#34;&gt;一点问题&lt;/h2&gt;
&lt;p&gt;由于运营商网关不受我们控制，外网的IP和端口号都是随机分配的，每当地址变化时，NATMap将执行自定义脚本。在上面的Wiki中，利用DDNS，把IPv4地址和端口编码进IPv6的AAAA记录中。这并不是一种标准的技术，不过既然&lt;code&gt;2001::&lt;/code&gt;就是给&lt;code&gt;teredo&lt;/code&gt;使用的，在这里随便用用也无所谓。&lt;/p&gt;
&lt;p&gt;对于Windows下的Wireguard客户端，我（和ChatGPT一起）写了一个&lt;a href=&#34;https://gist.github.com/heyeshuang/0054c73e3f2762f12a16165a5cfe8213#file-wg-ps1&#34;&gt;PowerShell脚本&lt;/a&gt;，能够自动修改配置文件的&lt;code&gt;Endpoint&lt;/code&gt;并调用&lt;code&gt;wireguard.exe&lt;/code&gt;进行连接。&lt;/p&gt;
&lt;p&gt;使用方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安装&lt;a href=&#34;https://github.com/WireGuard/wireguard-windows/blob/master/docs/enterprise.md&#34;&gt;wireguard-windows&lt;/a&gt;，用客户端连接测试成功。&lt;/li&gt;
&lt;li&gt;在文件夹&lt;code&gt;C:\example&lt;/code&gt;下建立&lt;a href=&#34;https://gist.github.com/heyeshuang/0054c73e3f2762f12a16165a5cfe8213#file-wg-ps1&#34;&gt;wg.ps1&lt;/a&gt;和&lt;a href=&#34;https://gist.github.com/heyeshuang/0054c73e3f2762f12a16165a5cfe8213#file-nat-conf&#34;&gt;nat.conf&lt;/a&gt;，粘贴Gist内容。&lt;/li&gt;
&lt;li&gt;按照实际情况修改&lt;code&gt;nat.conf&lt;/code&gt;，以及&lt;code&gt;wg.ps1&lt;/code&gt;中&lt;code&gt;$Hostname&lt;/code&gt;部分。&lt;code&gt;Endpoint&lt;/code&gt;不必修改。&lt;/li&gt;
&lt;li&gt;以管理员身份运行&lt;code&gt;PowerShell&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;设置&lt;code&gt;ps1&lt;/code&gt;脚本运行权限：&lt;code&gt;Set-ExecutionPolicy RemoteSigned&lt;/code&gt;（或Unrestricted）&lt;/li&gt;
&lt;li&gt;启动、重启Wireguard：&lt;code&gt;C:\example\wg.ps1 -up&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;停止Wireguard：&lt;code&gt;C:\example\wg.ps1 -down&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在Windows 11, Powershell  5.1.22621.963测试通过，也可以配合Windows下的&lt;a href=&#34;https://bjansen.github.io/scoop-apps/main/sudo/&#34;&gt;sudo&lt;/a&gt;使用。&lt;/p&gt;
&lt;p&gt;另外，在Android下，也可以用termux运行&lt;a href=&#34;https://gist.github.com/heyeshuang/0054c73e3f2762f12a16165a5cfe8213#file-nm-echo-sh&#34;&gt;nm-echo.sh&lt;/a&gt;来获得IP地址，手动修改Wireguard官方客户端中的IP。甚至，可以使用你喜欢的代理客户端（比如NB4A），配置好Wireguard Outbond和路由就可以了~&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/%E8%BF%9E%E6%8E%A5%E6%97%B6%E9%97%B4.png&#34;
    alt=&#34;我这里最近一次分配的端口坚持了18天，所以应该不必时常刷新。&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;我这里最近一次分配的端口坚持了18天，所以应该不必时常刷新。&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;如果需要更为稳定的访问，可以参考&lt;a href=&#34;https://gist.github.com/z0mb1e-kgd/54aede86adf2e30e390dba13886d18e1&#34;&gt;reresolve-dns.ps1&lt;/a&gt;，这个脚本可以在上一次握手时间过久时刷新DNS，但是因为要添加计划任务，有一点过于复杂了。&lt;/p&gt;
&lt;h2 id=&#34;bonus&#34;&gt;Bonus&lt;/h2&gt;
&lt;p&gt;Natmap的另一种用法是映射BT客户端，从而使外来连接能够主动发起连接，获得所谓的&lt;code&gt;High ID&lt;/code&gt;。见&lt;a href=&#34;https://github.com/wits-fe/bittorrent-NAT-hole-punching&#34;&gt;wits-fe/bittorrent-NAT-hole-punching&lt;/a&gt;。在PT站做种的时候应该会很有用。&lt;/p&gt;
&lt;h2 id=&#34;附性能测试&#34;&gt;附：性能测试&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;随便找了一个公共WiFi，用手机（一加7T）上Termux中的&lt;code&gt;iperf3&lt;/code&gt;测速。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;由于多层NAT的限制，Nebula类组网工具必须部署在路由器位置。可以看出，对路由器（万元级，K3）带来的压力还是比较大的。&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/iperf-1.svg&#34;
    alt=&#34;WireGuard for Android&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;WireGuard for Android&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/iperf-2.svg&#34;
    alt=&#34;NB4A提供的Wireguard Outbound&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;NB4A提供的Wireguard Outbound&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/05/10/through-nat/iperf-3.svg&#34;
    alt=&#34;Nebula，对端部署在路由器上&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;Nebula，对端部署在路由器上&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;很难想象，对于访问内网这样一个简单的需求，我居然花费了如此多的精力。不过，这次应该算是当前比较满意的方案，应该能坚持到下次水逆开始。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>仅IPv6家庭内网服务实现v6&#43;v4双栈访问</title>
      <link>http://localhost:1313/2023/02/07/beyond-nat-2023/</link>
      <pubDate>Tue, 07 Feb 2023 17:29:00 +0800</pubDate>
      
      <guid>http://localhost:1313/2023/02/07/beyond-nat-2023/</guid>
      <description>&lt;p&gt;是的，连回家里NAS的正常手段，当然是ZeroTier/Tinc/OpenVPN之类。但是如果还有其他人想要看照片的话，不要期待手机上会有除了浏览器之外的东西。&lt;/p&gt;
&lt;p&gt;在这种场景，如果：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;有一台常开的NAS、矿渣或whatever，&lt;/li&gt;
&lt;li&gt;在Cloudflare上有一个自己的域名，&lt;/li&gt;
&lt;li&gt;家里的宽带有IPv6，而且防火墙可以自己控制（aka 光猫桥接），&lt;/li&gt;
&lt;li&gt;不想或者不能打开80、443端口，没办法直接使用Cloudflare代理；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那么可以通过本文的方案，获得高位端口的CF代理。这样，在没有IPv6的地方也能够访问家里的服务了。&lt;/p&gt;
&lt;p&gt;如果上面的条件不满足的话，可以尝试&lt;code&gt;FRP&lt;/code&gt;和&lt;code&gt;Cloudflare Tunnel&lt;/code&gt;之类的东西。&lt;/p&gt;
&lt;h2 id=&#34;打开端口ddns&#34;&gt;打开端口、DDNS&lt;/h2&gt;
&lt;p&gt;首先我们需要保证NAS上的IPv6端口能从公网访问，并把域名指向家里的IPv6地址。打开端口的部分可以看看&lt;a href=&#34;http://localhost:1313/2021/07/20/beyond-nat/&#34;&gt;之前的博文&lt;/a&gt;；DDNS我在使用&lt;a href=&#34;https://github.com/jeessy2/ddns-go&#34;&gt;ddns-go&lt;/a&gt;（这里可能需要科学上网）。注意，此时先不要开启Cloudflare代理。&lt;/p&gt;
&lt;p&gt;完成这部分之后，我们的域名（比如说home.example.net）指向了家里的IP，并且防火墙打开了端口（比如38000）。可以在NAS上开个&lt;code&gt;python -m http.server 38000&lt;/code&gt;，并用移动网络测试一下。&lt;/p&gt;
&lt;p&gt;对了，Cloudflare的token不要扔，待会还有用。&lt;/p&gt;
&lt;h2 id=&#34;caddy&#34;&gt;Caddy&lt;/h2&gt;
&lt;p&gt;安装&lt;a href=&#34;https://caddyserver.com/download?package=github.com%2Fcaddy-dns%2Fcloudflare&#34;&gt;包含Cloudflare DNS插件的Caddy&lt;/a&gt;。因为家里没有80和443端口，所以需要用DNS-01方式申请TLS证书：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Caddyfile&#34; data-lang=&#34;Caddyfile&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;## cat /etc/caddy/Caddyfile
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;&lt;/span&gt;(cloudflare) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;tls&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;dns&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;cloudflare&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;abcdefgh&lt;/span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt; #刚才说的Cloudflare的token
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;&lt;/span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#030;font-weight:bold&#34;&gt;home.example.net:38000&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;reverse_proxy&lt;/span&gt; http://localhost:&lt;span style=&#34;color:#f60&#34;&gt;1234&lt;/span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt; #这里是内网服务的地址
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;import&lt;/span&gt; cloudflare&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt; #申请证书的部分
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;开启Caddy。这里结束后，移动网络（就是有IPv6地址的网络）应该能够通过&lt;code&gt;https://home.example.net:38000&lt;/code&gt;访问服务了。&lt;/p&gt;
&lt;h2 id=&#34;cloudflare&#34;&gt;Cloudflare&lt;/h2&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/02/07/beyond-nat-2023/SSL_TLS.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;把SSL/TLS加密模式改为完全；&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2023/02/07/beyond-nat-2023/Origin_Rules.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;添加Origin Rules，把请求转至高位端口；&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;开启Cloudflare代理。&lt;a href=&#34;https://github.com/jeessy2/ddns-go/issues/336&#34;&gt;在DDNS服务上也开启Cloudflare代理&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;好了，大概就是这样。通过CF，也许自家的网络也能稍微安全一点。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>你可能并不需要内网穿透</title>
      <link>http://localhost:1313/2021/07/20/beyond-nat/</link>
      <pubDate>Tue, 20 Jul 2021 17:03:31 +0800</pubDate>
      
      <guid>http://localhost:1313/2021/07/20/beyond-nat/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;最近搬家了，互联网从联通变成了便宜一些的电信。于是，我失去了之前的公网IP&lt;code&gt;114.*.*.*&lt;/code&gt;，换来了&lt;code&gt;100.64.*.*&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。不过，IPv6地址仍然是&lt;code&gt;2404::****&lt;/code&gt;，这个应该也算是所谓的 &lt;em&gt;公网IP&lt;/em&gt; 吧？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;准备&#34;&gt;准备&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;和安装网络的大叔说，我需要把光猫改成桥接模式，并保证“咱是专业的，不会弄坏网线，弄坏了也不会去投诉”；&lt;/li&gt;
&lt;li&gt;找一个稍微新一点的路由器，我用的是刷了&lt;code&gt;OpenWRT&lt;/code&gt;的，&lt;strong&gt;非常贵的&lt;/strong&gt;跑路K3；&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://test-ipv6.com&#34;&gt;test-ipv6.com&lt;/a&gt;显示了IPv6地址而且没有给你打零分。&lt;/li&gt;
&lt;/ol&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2021/07/20/beyond-nat/ipv6-test.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;比如这样&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&#34;打开端口&#34;&gt;打开端口&lt;/h2&gt;
&lt;p&gt;虽然没有了NAT，但是防火墙还是必不可少的，毕竟在互联网上随意敞开自己的端口和裸奔没有什么区别。当然，稍微露出一点点的话没有什么问题，所以我开了几个五位数的端口，用来SSH。&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2021/07/20/beyond-nat/ipv6-firewall.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;就像这样（图像经过处理，实际上有更多规则，而且端口也不是这几个）&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;如果对安全要求更高的话，可以参考&lt;a href=&#34;https://blog.ptsang.net/match-ipv6-dynamic-addresses-in-iptables?utm_source=pocket_mylist&#34;&gt;这里&lt;/a&gt;匹配IPv6地址的末几位，就像&lt;code&gt;::abcd:1234:5678:90ef/::ffff:ffff:ffff:ffff&lt;/code&gt;这样。&lt;/p&gt;
&lt;p&gt;在这个时候，你应该已经可以通过手机移动网络用SSH连接回自己主机的IPv6地址了。就和公网一模一样。&lt;/p&gt;
&lt;h2 id=&#34;绑定域名&#34;&gt;绑定域名&lt;/h2&gt;
&lt;p&gt;任何一个支持IPv6的AAAA地址绑定的DDNS服务都可以。我家里恰好有一个长期开机的矿渣&lt;code&gt;贝壳云&lt;/code&gt;，是某次水逆之后想要买树莓派四，忍住了却又没有完全忍住的结果；之前写的&lt;a href=&#34;http://localhost:1313/2018/07/05/cloudflare-ddns/&#34;&gt;cloudflare脚本&lt;/a&gt;刚好能用。&lt;/p&gt;
&lt;h2 id=&#34;跳板机自称&#34;&gt;跳板机（自称）&lt;/h2&gt;
&lt;p&gt;如果想对内网完全控制，而不是仅仅几个端口的话，可能需要所谓跳板机的配合。仔细想想，这是一个跨越&lt;code&gt;防火墙.little&lt;/code&gt;的活动，对付&lt;code&gt;防火墙 the Great&lt;/code&gt;的软件也完全适用。所以我在内网设备（aka矿渣）上部署了某个V开头的软件，通过Android客户端连回家里完全没有问题&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;如果外面的Windows想要进来的话，我现在用的是已经跑路的&lt;code&gt;SocksCap64&lt;/code&gt;&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;。把&lt;code&gt;MSTSC.exe&lt;/code&gt;加到列表里，就可以愉快地远程桌面了。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;来自210805的更新：后来我按照&lt;a href=&#34;https://chanix.github.io/TincCookbook/introduction/&#34;&gt;这篇教程&lt;/a&gt;在矿渣上部署了tinc，并且增加了&lt;a href=&#34;https://tinc-vpn.org/examples/proxy-arp/&#34;&gt;ARP代理&lt;/a&gt;用来访问内网。我又不能直接把家里的老光猫换掉……&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;用于在电信级NAT环境中服务提供商与其用户通信，&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E4%BF%9D%E7%95%99IP%E5%9C%B0%E5%9D%80&#34;&gt;维基百科&lt;/a&gt;上说的。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;记住客户端不要&lt;code&gt;绕过局域网地址&lt;/code&gt;，我们用的就是局域网。&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;TODO：急求一款没有跑路的、免费的、Windows下的全局代理软件。&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>一个新主题</title>
      <link>http://localhost:1313/2020/05/17/a-new-theme/</link>
      <pubDate>Sun, 17 May 2020 20:05:46 +0800</pubDate>
      
      <guid>http://localhost:1313/2020/05/17/a-new-theme/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;mockup2.png&#34; alt=&#34;mockup&#34;&gt;&lt;/p&gt;
&lt;p&gt;项目地址：&lt;a href=&#34;https://github.com/heyeshuang/hugo-theme-tokiwa&#34;&gt;https://github.com/heyeshuang/hugo-theme-tokiwa&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;大概是3月末，我在例行的&lt;code&gt;检查博客有没有自己偷偷更新&lt;/code&gt;的活动中，开始对这个网页感到厌烦了。同时，我在一个月的高强度&lt;del&gt;打牌&lt;/del&gt;&lt;a href=&#34;https://store.steampowered.com/app/582010/MONSTER_HUNTER_WORLD/&#34;&gt;狩猎&lt;/a&gt;之后，自我厌恶感达到了又一个峰值。又到了做些什么的时间了。&lt;/p&gt;
&lt;p&gt;中间的事情，比如说连续加班21天啊，往肋间插了根管子啊，暂且按下不表。作为结果，我的博客变成了现在的样子。&lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;
  &lt;h4 class=&#34;inline&#34;&gt;
    （万一我在很久之后换掉了主题，这里还有一些截图。）
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2020/05/17/a-new-theme/screenshot1.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;主页的样子&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2020/05/17/a-new-theme/screenshot2.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;内文的样子&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/2020/05/17/a-new-theme/screenshot3.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;在手机上的样子&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/details&gt;
&lt;p&gt;新主题继承了之前的配色，也以配色而命名。记得&lt;a href=&#34;http://localhost:1313/2017/06/12/moving-to-hugo-3/&#34;&gt;当时&lt;/a&gt;我选了主题&lt;code&gt;blackburn&lt;/code&gt;，又觉得默认的蓝色有些“默认”，于是自己挑了一种，恰好是现在所说的常磐色。嗯，看起来绿油油的。&lt;/p&gt;
&lt;p&gt;其他的方面，用了现在流行的、尽情浪费显示器空间的布局，还用了尽情浪费网路流量的网页字体。用2M流量换一个帅气的标题，feels good man&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;另外，现在正在试图向&lt;a href=&#34;https://github.com/gohugoio/hugoThemes/issues/850&#34;&gt;gohugoio/hugoThemes&lt;/a&gt;投稿，当前（2020-5-19）的进度是在与老外激情对线。都2020年了，我居然因为开源许可证气得睡不着觉，感觉自己的青春又回来了。&lt;/p&gt;
&lt;p&gt;我没什么好交代的了。下次见。&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;来自2020-6-1的更新：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我突然发现自己连项目的主页都没有写……放在前面了。&lt;/p&gt;
&lt;p&gt;另外，如果要剪裁字体，而且安装了&lt;code&gt;node.js&lt;/code&gt;的话，可以使用下面的命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;npx fontmin 字体名称.ttf -t &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;要用到的字形&amp;#34;&lt;/span&gt; &amp;gt; 字体名称-剪裁后.ttf 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;因为我一直没有一台特别可靠的服务器，正文用的字体就不自动剪裁了。也算是给5G一个应用场景吧？虽然还没有用上。&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;来自2020-6-12的更新：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;终于通过了Hugo Themes的投稿：&lt;a href=&#34;https://themes.gohugo.io/hugo-theme-tokiwa/&#34;&gt;https://themes.gohugo.io/hugo-theme-tokiwa/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;That&#39;s a long trip.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;来自2020-6-14的更新：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从&lt;a href=&#34;https://blog.shuiba.co/lots-stuff-of-new-theme&#34;&gt;专业人士&lt;/a&gt;那里学到了头图的做法。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;说笑的，待会我就会把字体裁好。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>用Cloudflare的v4 API实现动态DNS（DDNS）</title>
      <link>http://localhost:1313/2018/07/05/cloudflare-ddns/</link>
      <pubDate>Thu, 05 Jul 2018 21:41:42 +0800</pubDate>
      
      <guid>http://localhost:1313/2018/07/05/cloudflare-ddns/</guid>
      <description>&lt;p&gt;如果你有一个经常变化的公网IP，你可能会需要用DDNS将这个IP绑定在同一个域名上，这样就可以不必每次输入一串IP地址了。我用的DNS服务商Cloudflare并没有提供名为DDNS的服务，但是其API可以实现类似的效果。&lt;/p&gt;
&lt;p&gt;之前我用的是&lt;a href=&#34;https://lifely.today/2015/05/%E7%82%BA-cloudflare-%E8%A8%AD%E5%AE%9A%E5%8B%95%E6%85%8B-dns-ddns/&#34;&gt;这里&lt;/a&gt;的方法，不过最近cloudflare更新了&lt;a href=&#34;https://api.cloudflare.com/&#34;&gt;第四代API&lt;/a&gt;，那个方法已经失效。于是水博文的机会来了。&lt;/p&gt;
&lt;p&gt;原料：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;一个域名，并用Cloudflare管理&lt;/li&gt;
&lt;li&gt;一台经常开着的，有计划任务或者cron，可以运行curl的电脑&lt;/li&gt;
&lt;li&gt;（可选）如果API地址被屏蔽的话，可能需要可用的代理&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;去&lt;a href=&#34;https://dash.cloudflare.com/&#34;&gt;https://dash.cloudflare.com/&lt;/a&gt;找到你域名的&lt;code&gt;zone ID&lt;/code&gt;并新建一个~~&lt;code&gt;API_KEY&lt;/code&gt;~~用于单个域名的&lt;code&gt;API token&lt;/code&gt;。&lt;code&gt;API_KEY&lt;/code&gt;因为权限过高，不建议使用。&lt;/li&gt;
&lt;li&gt;新建一条子域名的A记录，IP写什么都行。&lt;/li&gt;
&lt;li&gt;查询这条记录的&lt;code&gt;RECORD_ID&lt;/code&gt;，在终端运行：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -X GET &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;https://api.cloudflare.com/client/v4/zones/&amp;lt;ZONE_ID&amp;gt;/dns_records&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Authorization: Bearer &amp;lt;API token&amp;gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -x http://localhost:8087
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中 &lt;code&gt;-x&lt;/code&gt;是本地代理地址，可选。大概能从返回的一坨json中找到id那一项。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;保存下面的脚本，修改&lt;code&gt;&amp;lt;ZONE_ID&amp;gt;&lt;/code&gt;，&lt;code&gt;&amp;lt;RECORD_ID&amp;gt;&lt;/code&gt;，&lt;code&gt;邮箱地址&lt;/code&gt;，&lt;code&gt;API_KEY&lt;/code&gt;，&lt;code&gt;子域名&lt;/code&gt;什么的。如果不需要代理的话删除&lt;code&gt;-x&lt;/code&gt;那一行。&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;
  &lt;h4 class=&#34;inline&#34;&gt;
    IPv4的情况
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#099&#34;&gt;#!/bin/sh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#099&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;curl http://members.3322.org/dyndns/getip&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#033&#34;&gt;CURRENT_IP&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;cat /var/tmp/current_ip.txt&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$CURRENT_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;No Change in IP Adddress&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#033&#34;&gt;OUTPUT&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;curl -X PUT &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;https://api.cloudflare.com/client/v4/zones/&amp;lt;ZONE_ID&amp;gt;/dns_records/&amp;lt;RECORD_ID&amp;gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -x http://&amp;lt;代理地址，不要的话删去这一行&amp;gt;:8087 &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Authorization: Bearer &amp;lt;API token&amp;gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     --data &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;{&amp;#34;type&amp;#34;:&amp;#34;A&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;&amp;lt;子域名地址&amp;gt;&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;&amp;#34;,&amp;#34;ttl&amp;#34;:1}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$OUTPUT&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; | grep -q &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Update IP Success!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt; &amp;gt; /var/tmp/current_ip.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Update Error!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;
  &lt;h4 class=&#34;inline&#34;&gt;
    IPv6的情况，放在两个不同的脚本里面可以共存
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#099&#34;&gt;#!/bin/sh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#099&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;ip -6 addr | grep inet6 | awk -F &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;[ \t]+|/&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;{print $3}&amp;#39;&lt;/span&gt; | grep -v ^::1 | grep -v ^fe80 | head -n 1&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#033&#34;&gt;CURRENT_IP&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;cat /var/tmp/current_ip_6.txt&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$CURRENT_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;No Change in IP Adddress!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#033&#34;&gt;OUTPUT&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;$(&lt;/span&gt;curl -X PUT &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;https://api.cloudflare.com/client/v4/zones/&amp;lt;ZONE_ID&amp;gt;/dns_records/&amp;lt;RECORD_ID&amp;gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -x socks5h://&amp;lt;代理地址，不要的话删去这一行&amp;gt;:1085 &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Authorization: Bearer &amp;lt;API token&amp;gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     -H &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;&lt;/span&gt;     --data &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;{&amp;#34;type&amp;#34;:&amp;#34;AAAA&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;&amp;lt;子域名&amp;gt;.&amp;lt;域名&amp;gt;.xyz&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;&amp;#34;,&amp;#34;ttl&amp;#34;:1}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$OUTPUT&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt; | grep -q &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Update IP Success!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#033&#34;&gt;$NEW_IP&lt;/span&gt; &amp;gt; /var/tmp/current_ip_6.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#366&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;Update Error!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/details&gt;
&lt;ul&gt;
&lt;li&gt;接下来让它每两个小时运行一次就好了。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#09f;font-style:italic&#34;&gt;# crontab -e&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;*/120 * * * * /path/of/your/script.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;del&gt;写字好累（躺&lt;/del&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;来自19-10-25的更新：DNSpod的公网IP查询服务响应有些奇怪，所以换成了3322。&lt;/p&gt;
&lt;p&gt;来自20-06-23：增加了判断，现在不会在一次网络问题后直接写入&lt;code&gt;current_ip.txt&lt;/code&gt;了。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>迁移到hugo，第三部分：可是我想要更多的feed地址…</title>
      <link>http://localhost:1313/2017/06/12/moving-to-hugo-3/</link>
      <pubDate>Mon, 12 Jun 2017 22:25:07 +0800</pubDate>
      
      <guid>http://localhost:1313/2017/06/12/moving-to-hugo-3/</guid>
      <description>&lt;p&gt;之前在 &lt;a href=&#34;http://heyeshuang.tk&#34;&gt;http://heyeshuang.tk&lt;/a&gt; 这个域名下的时候，wordpress提供的RSS feed地址格式类似 &lt;a href=&#34;http://heyeshuang.tk/feed/&#34;&gt;http://heyeshuang.tk/feed/&lt;/a&gt; ，但是hugo提供的RSS地址是&lt;code&gt;index.xml&lt;/code&gt;样子的，而且我翻遍了manual也没看到给RSS加alias的方法。&lt;/p&gt;
&lt;p&gt;所以只能改模版了，思路是把&lt;code&gt;/feed&lt;/code&gt;目录的列表页渲染成RSS的样子，我是直接在主题里面改的：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\themes\&amp;lt;主题名字&amp;gt;\layouts\feed\list.html&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;rss&lt;/span&gt; &lt;span style=&#34;color:#309&#34;&gt;version&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;2.0&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#309&#34;&gt;xmlns:atom&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;http://www.w3.org/2005/Atom&amp;#34;&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;channel&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;title&lt;/span&gt;&amp;gt;{{ if eq  .Title  .Site.Title }}{{ .Site.Title }}{{ else }}{{ with .Title }}{{.}} on {{ end }}{{ .Site.Title }}{{ end }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;title&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;link&lt;/span&gt;&amp;gt;{{ .Permalink }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;link&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;description&lt;/span&gt;&amp;gt;Recent content {{ if ne  .Title  .Site.Title }}{{ with .Title }}in {{.}} {{ end }}{{ end }}on {{ .Site.Title }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;description&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;generator&lt;/span&gt;&amp;gt;Hugo -- gohugo.io&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;generator&lt;/span&gt;&amp;gt;{{ with .Site.LanguageCode }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;language&lt;/span&gt;&amp;gt;{{.}}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;language&lt;/span&gt;&amp;gt;{{end}}{{ with .Site.Author.email }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;managingEditor&lt;/span&gt;&amp;gt;{{.}}{{ with $.Site.Author.name }} ({{.}}){{end}}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;managingEditor&lt;/span&gt;&amp;gt;{{end}}{{ with .Site.Author.email }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;webMaster&lt;/span&gt;&amp;gt;{{.}}{{ with $.Site.Author.name }} ({{.}}){{end}}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;webMaster&lt;/span&gt;&amp;gt;{{end}}{{ with .Site.Copyright }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;copyright&lt;/span&gt;&amp;gt;{{.}}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;copyright&lt;/span&gt;&amp;gt;{{end}}{{ if not .Date.IsZero }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;lastBuildDate&lt;/span&gt;&amp;gt;{{ .Date.Format &amp;#34;Mon, 02 Jan 2006 15:04:05 -0700&amp;#34; | safeHTML }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;lastBuildDate&lt;/span&gt;&amp;gt;{{ end }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;atom:link&lt;/span&gt; &lt;span style=&#34;color:#309&#34;&gt;href&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;{{.Permalink}}&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#309&#34;&gt;rel&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;self&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#309&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;application/rss+xml&amp;#34;&lt;/span&gt; /&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {{ range .Site.RegularPages }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;item&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;title&lt;/span&gt;&amp;gt;{{ .Title }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;title&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;link&lt;/span&gt;&amp;gt;{{ .Permalink }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;link&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;pubDate&lt;/span&gt;&amp;gt;{{ .Date.Format &amp;#34;Mon, 02 Jan 2006 15:04:05 -0700&amp;#34; | safeHTML }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;pubDate&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      {{ with .Site.Author.email }}&amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;author&lt;/span&gt;&amp;gt;{{.}}{{ with $.Site.Author.name }} ({{.}}){{end}}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;author&lt;/span&gt;&amp;gt;{{end}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;guid&lt;/span&gt;&amp;gt;{{ .Permalink }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;guid&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;description&lt;/span&gt;&amp;gt;{{ .Content | html }}&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;description&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;item&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {{ end }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;channel&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;/&lt;span style=&#34;color:#309;font-weight:bold&#34;&gt;rss&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;基本上就是hugo自带的RSS模板，除了把&lt;code&gt;{{ range .Data.Pages }}&lt;/code&gt;改成了&lt;code&gt;{{ range .Site.RegularPages }}&lt;/code&gt;，因为我需要生成整个网站的RSS。另外，修改过的主题在&lt;a href=&#34;https://github.com/yoshiharuyamashita/blackburn&#34;&gt;https://github.com/yoshiharuyamashita/blackburn&lt;/a&gt;，稍微改了一些小bug，还换了个颜色。&lt;del&gt;哪天我要把名字改成greenfreeze。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;然后别忘了新建一个&lt;code&gt;\content\feed\chicken.md&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;title: &amp;#39;chicken&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;author: HeYSH
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;date: 2012-06-22T06:32:32+00:00
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;aliases:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  - /%3ffeed%3drss2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Nothing here.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;当然，类似&lt;code&gt;/?feed=rss2&lt;/code&gt;这样的地址就用不了了，我试过的。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>由wordpress到hugo：I</title>
      <link>http://localhost:1313/2017/06/07/moving-to-hugo/</link>
      <pubDate>Wed, 07 Jun 2017 22:14:47 +0800</pubDate>
      
      <guid>http://localhost:1313/2017/06/07/moving-to-hugo/</guid>
      <description>&lt;p&gt;我之前的wordpress博客是建在redhat公司的OpenShift服务上的，距&lt;a href=&#34;http://localhost:1313/2015/08/23/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E7%9A%84%E6%89%8B%E6%9C%BA%E7%94%A8%E4%B8%8D%E4%BA%86ipv6%EF%BC%9F/&#34;&gt;上次&lt;/a&gt;我更换博客后台过了快两年时间，wordpress（或是PHP）再次把空间占满了，而不懂PHP的我只能对着SFTP干瞪眼。于是，我又种了一棵新的树苗。&lt;/p&gt;
&lt;p&gt;wordpress的文章是通过&lt;a href=&#34;https://github.com/SchumacherFM/wordpress-to-hugo-exporter&#34;&gt;wordpress-to-hugo-exporter&lt;/a&gt;导出的，但是导出的文件有一些小问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;标题里都是&lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;正文还是&lt;code&gt;HTML&lt;/code&gt;格式&lt;/li&gt;
&lt;li&gt;&lt;code&gt;img&lt;/code&gt;和&lt;code&gt;code&lt;/code&gt;需要修改&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于正文，可以用&lt;code&gt;pandoc&lt;/code&gt;和&lt;code&gt;pypandoc&lt;/code&gt;转换：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#0cf;font-weight:bold&#34;&gt;pypandoc&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#0cf;font-weight:bold&#34;&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;root &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;./content&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; rt, dirs, files &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; os&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;walk(root):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; filename &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; files:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;with&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;open&lt;/span&gt;(os&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;join(rt, filename), &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;, encoding&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;as&lt;/span&gt; fin:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            data &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; fin&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;read()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ds &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;---&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ds[&lt;span style=&#34;color:#f60&#34;&gt;2&lt;/span&gt;] &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; pypandoc&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;convert_text(ds[&lt;span style=&#34;color:#f60&#34;&gt;2&lt;/span&gt;], &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;md&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#366&#34;&gt;format&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;html&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        do &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;---&lt;/span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;join(ds)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;with&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;open&lt;/span&gt;(filename, &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;, encoding&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;as&lt;/span&gt; file:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            file&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;write(do)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其他的……手改保平安……&lt;/p&gt;
&lt;p&gt;……&lt;/p&gt;
&lt;p&gt;……………&lt;/p&gt;
&lt;p&gt;漫长的修改过后，用&lt;code&gt;hugo server -w&lt;/code&gt;预览。&lt;/p&gt;
&lt;p&gt;这时候还有一个小问题：&lt;code&gt;hugo&lt;/code&gt;生成URL不一定遵循文件头&lt;code&gt;url&lt;/code&gt;定义，比如，对
&lt;code&gt;/2016/06/13/qart-coder：更友好的qr码/&lt;/code&gt;，&lt;code&gt;hugo&lt;/code&gt;会解析为&lt;code&gt;/2016/06/13/qart-coder更友好的qr码/&lt;/code&gt;。看出区别了吗？&lt;/p&gt;
&lt;p&gt;为了保证（不知道和谁的）兼容性，可以在文件头中增加&lt;code&gt;aliases&lt;/code&gt;行，可以将原来的地址转发到新地址。&lt;/p&gt;
&lt;p&gt;同样的，我也写了一个辣鸡脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#0cf;font-weight:bold&#34;&gt;pypandoc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#0cf;font-weight:bold&#34;&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;root &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;./content&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; rt, dirs, files &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; os&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;walk(root):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; filename &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; files:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;with&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;open&lt;/span&gt;(os&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;join(rt, filename), &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;, encoding&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;as&lt;/span&gt; fin:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            data &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; fin&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;readlines()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                urlIndex &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; [n &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; n, l &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;enumerate&lt;/span&gt;(data) &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;if&lt;/span&gt; l&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;find(&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;url:&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#555&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#f60&#34;&gt;1&lt;/span&gt;][&lt;span style=&#34;color:#f60&#34;&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                url &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; data[urlIndex]&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;url:&amp;#34;&lt;/span&gt;)[&lt;span style=&#34;color:#f60&#34;&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                aliasLine &lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;  -&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#555&#34;&gt;+&lt;/span&gt; url
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                data&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;insert(urlIndex &lt;span style=&#34;color:#555&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f60&#34;&gt;1&lt;/span&gt;, aliasLine)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                data&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;insert(urlIndex &lt;span style=&#34;color:#555&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#f60&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;aliases:&lt;/span&gt;&lt;span style=&#34;color:#c30;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;except&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;with&lt;/span&gt; &lt;span style=&#34;color:#366&#34;&gt;open&lt;/span&gt;(filename, &lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;, encoding&lt;span style=&#34;color:#555&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c30&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;as&lt;/span&gt; file:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#069;font-weight:bold&#34;&gt;for&lt;/span&gt; d &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;in&lt;/span&gt; data:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                file&lt;span style=&#34;color:#555&#34;&gt;.&lt;/span&gt;write(d)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>迁移到hugo，第二部分：部署到github</title>
      <link>http://localhost:1313/2017/06/07/moving-to-hugo-with-git/</link>
      <pubDate>Wed, 07 Jun 2017 22:07:44 +0800</pubDate>
      
      <guid>http://localhost:1313/2017/06/07/moving-to-hugo-with-git/</guid>
      <description>&lt;p&gt;书接上文 &lt;del&gt;（虽然我是先写的这一篇）&lt;/del&gt;，当我们有了一个可用的hugo目录后，就可以把它部署到github等静态网页托管服务了。如果你的强迫症不是很严重的话，可以把&lt;code&gt;/public&lt;/code&gt;目录直接push到新的repo里；不过如果为了得到一个整洁的主页，可以用同一个repo的&lt;code&gt;master&lt;/code&gt;分支保存源文件，&lt;code&gt;gh-page&lt;/code&gt;分支来展示，像&lt;a href=&#34;http://www.gohugo.org/doc/tutorials/github-pages-blog/&#34;&gt;这里&lt;/a&gt;说的那样。&lt;/p&gt;
&lt;p&gt;这里假设你已经&lt;code&gt;init&lt;/code&gt;过了你的&lt;code&gt;hugo&lt;/code&gt;目录：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Create a new orphand branch (no commit history) named gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git checkout --orphan gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Unstage all files
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git rm --cached $(git ls-files)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Grab one file from the master branch so we can make a commit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git checkout master README.md
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Add and commit that file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git add .
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git commit -m &amp;#34;INIT: initial commit on gh-pages branch&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Push to remote gh-pages branch
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git push origin gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Return to master branch
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git checkout master
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Remove the public folder to make room for the gh-pages subtree
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rm -rf public
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Add the gh-pages branch of the repository. It will look like a folder named public
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git subtree add --prefix=public &amp;lt;你的.git地址&amp;gt; gh-pages --squash
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Pull down the file we just committed. This helps avoid merge conflicts
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# 这里我先push了一次，否则会出现fatal: refusing to merge unrelated histories
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# 好像是git的bug
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git subtree push --prefix=public &amp;lt;你的.git地址&amp;gt; gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git subtree pull --prefix=public &amp;lt;你的.git地址&amp;gt; gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Add everything
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git add -A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Commit and push to master
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git commit -m &amp;#34;Updating site&amp;#34; &amp;amp;&amp;amp; git push origin master
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# Push the public subtree to the gh-pages branch
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git subtree push --prefix=public &amp;lt;你的.git地址&amp;gt; gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;之后每次更新需要&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hugo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git add -A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git commit -m &amp;#34;some messages&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git push origin master
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git subtree push --prefix=public &amp;lt;你的.git地址&amp;gt; gh-pages
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;像我这样的强迫症可以把主题也做一个&lt;code&gt;subtree&lt;/code&gt;出来。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>shadowsocks 2016: 一次性认证，KCP及其他</title>
      <link>http://localhost:1313/2016/10/25/shadowsocks-2016-%E4%B8%80%E6%AC%A1%E6%80%A7%E8%AE%A4%E8%AF%81%EF%BC%8Ckcp%E5%8F%8A%E5%85%B6%E4%BB%96/</link>
      <pubDate>Tue, 25 Oct 2016 13:03:46 +0000</pubDate>
      
      <guid>http://localhost:1313/2016/10/25/shadowsocks-2016-%E4%B8%80%E6%AC%A1%E6%80%A7%E8%AE%A4%E8%AF%81%EF%BC%8Ckcp%E5%8F%8A%E5%85%B6%E4%BB%96/</guid>
      <description>&lt;p&gt;今天下午我的Bandwagon服务器被人爆掉了，让人发了一大堆垃圾邮件，于是有了一个重装的理由。终于可以用服务器原生IPv6了~&lt;/p&gt;
&lt;p&gt;距我上次配置shadowsocks服务端（2015.1）已经有一年半了，这次安装可以把上次没有加入的特性通通带上：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一次性认证，好像是当时和SSR打的时候加入的特性&lt;/li&gt;
&lt;li&gt;chacha20，上次没加好像是因为懒&lt;/li&gt;
&lt;li&gt;KCPtun，既然现在android客户端带上了这个功能，那就也装上吧&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;大概会稍微快一些吧……&lt;/p&gt;
&lt;p&gt;对了，顺便配个iptables，象征性地防守下。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;update 161122:&lt;/p&gt;
&lt;p&gt;象征性的防守被漫不经心的进攻给破掉了，于是增加了一些稍微认真一点的防守：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;禁用root登录和密码登录，顺便配置了sudo；&lt;/li&gt;
&lt;li&gt;用ufw代替直接配置iptables；&lt;/li&gt;
&lt;li&gt;fail2ban（后来发现debian 8带的0.8版本并不支持debian 8的journalctl……interesting）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最主要的，换了一个ip地址&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>IPv6 season 2: 在DHCPv6网络环境下的OpenWRT Chaos Calmer</title>
      <link>http://localhost:1313/2015/09/09/ipv6-season-2-%E5%9C%A8dhcpv6%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84openwrt-chaos-calmer/</link>
      <pubDate>Wed, 09 Sep 2015 13:58:27 +0000</pubDate>
      
      <guid>http://localhost:1313/2015/09/09/ipv6-season-2-%E5%9C%A8dhcpv6%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84openwrt-chaos-calmer/</guid>
      <description>&lt;p&gt;背景：桥接3秒断一次的渣网，以及经常在我博客中出现的5手db120；还有经常更新以后把老版本脚本删掉的OpenWRT，这里用的是Chaos Calmer 15.05-rc3。&lt;/p&gt;
&lt;p&gt;大概上思路和&lt;a href=&#34;http://talk.withme.me/?p=51&#34;&gt;这里&lt;/a&gt;一样，因为学校给的地址位数只有/64，不够再去划分子网，所以要去启用邻居发现协议；但是因为&lt;code&gt;6ndp&lt;/code&gt;,&lt;code&gt;ndppd&lt;/code&gt;和&lt;code&gt;radvd&lt;/code&gt;都已经被始乱终弃，现在它们的功能被odhcpd给代替了。具体上，&lt;code&gt;/etc/config/dhcp&lt;/code&gt;的关键几行大概应该是这样：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# /etc/config/dhcp:
config dhcp &#39;lan&#39;
        option interface &#39;lan&#39;
        option start &#39;100&#39;
        option limit &#39;150&#39;
        option leasetime &#39;12h&#39;
#       option dhcpv6 &#39;server&#39;
        option ra &#39;relay&#39;
        option ndp &#39;relay&#39;
#config dhcp &#39;wan&#39;
        #option interface &#39;wan&#39;
        #option ignore &#39;1&#39;
config dhcp &#39;wan6&#39;
        option ra &#39;relay&#39;
        option ndp &#39;relay&#39;
        option master &#39;1&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外，还需要把&lt;code&gt;luci&lt;/code&gt;的&lt;code&gt;interface&lt;/code&gt;页面下的&lt;code&gt;IPv6 ULA-Prefix&lt;/code&gt;删掉。&lt;/p&gt;
&lt;p&gt;现在的问题是，LAN口和WAN口的IP地址是一样的，而且客户机必须先ping一下这个地址才能连接外网，有时候路由还要重启&lt;code&gt;/etc/init.d/odhcpd&lt;/code&gt;；不管了，我先在这里存个盘。&lt;/p&gt;
&lt;p&gt;有人说relay-&amp;gt;hybrid也能成功的样子……我还没有测试过。&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://bbs.pku.edu.cn/new/bbs/article/showthread/Networking/15501646?1&#34;&gt;http://bbs.pku.edu.cn/new/bbs/article/showthread/Networking/15501646?1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://ict.jingyan.info/openwrt-%e7%94%a8odpcpd%e9%85%8d%e7%bd%aerelay-%e6%96%b9%e5%bc%8f-ipv6/&#34;&gt;http://ict.jingyan.info/openwrt-%e7%94%a8odpcpd%e9%85%8d%e7%bd%aerelay-%e6%96%b9%e5%bc%8f-ipv6/&lt;/a&gt;（链接不知道为什么已经失效了）&lt;/p&gt;
&lt;p&gt;20160321更新：odhcp烂的抠脚，转用邪恶的IPV6 NAT，见&lt;a href=&#34;https://wiki.openwrt.org/doc/howto/ipv6.nat6&#34;&gt;这里&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>红色楼梯</title>
      <link>http://localhost:1313/2014/05/16/%E7%BA%A2%E8%89%B2%E6%A5%BC%E6%A2%AF/</link>
      <pubDate>Fri, 16 May 2014 15:09:05 +0000</pubDate>
      
      <guid>http://localhost:1313/2014/05/16/%E7%BA%A2%E8%89%B2%E6%A5%BC%E6%A2%AF/</guid>
      <description>&lt;p&gt;用three.js试着做了点东西&lt;/p&gt;
&lt;p&gt;Live demo : &lt;a href=&#34;http://heyeshuang.github.io/three-stairs/&#34;&gt;http://heyeshuang.github.io/three-stairs/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;–你的下一句话是：“又做了没用的东西！”\&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;–是啊。\&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;–咦？这算是猜对了吗？&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>个人主页上线</title>
      <link>http://localhost:1313/2013/08/12/%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%E4%B8%8A%E7%BA%BF/</link>
      <pubDate>Mon, 12 Aug 2013 06:23:40 +0000</pubDate>
      
      <guid>http://localhost:1313/2013/08/12/%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%E4%B8%8A%E7%BA%BF/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://heyeshuang.github.io&#34;&gt;http://heyeshuang.github.io&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;请使用现代浏览器并开启硬件加速&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>贺叶霜的树</title>
      <link>http://localhost:1313/2013/04/27/%E8%B4%BA%E5%8F%B6%E9%9C%9C%E7%9A%84%E6%A0%91/</link>
      <pubDate>Sat, 27 Apr 2013 08:22:17 +0000</pubDate>
      
      <guid>http://localhost:1313/2013/04/27/%E8%B4%BA%E5%8F%B6%E9%9C%9C%E7%9A%84%E6%A0%91/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/heyeshuang/my_tree_2d&#34;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://heyeshuang.github.io/my_tree_2d&#34;&gt;live demo(slow)&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>